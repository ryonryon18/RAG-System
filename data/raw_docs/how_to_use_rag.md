# RAGの仕組み

RAG（Retrieval-Augmented Generation）は、外部文書から情報を検索し、言語モデルの応答に組み込む構造です。

主な処理の流れは以下の通りです：

## 1. チャンク分割

ドキュメントは意味の通る長さに分割され（例：300トークン）、各チャンクが検索対象になります。

## 2. ベクトル化（Embedding）

分割されたチャンクをベクトルに変換します。ベクトルとは文書の意味を数値化したもので、OpenAIやSentenceTransformersなどのモデルが使われます。

## 3. クエリのEmbeddingと検索

ユーザーの質問も同様にEmbeddingされ、チャンクと比較して意味が近いものをRetrieverが選びます（例：Top-k、MMR、Hybrid）。

## 4. 生成（Generation）

選ばれたチャンクをLLMに与えて、文脈に沿った自然な回答を生成します。

---

この4ステップにより、RAGはLLMに動的かつ信頼性のある知識を与えることができます。
